{% macro print_cert_overview(host,port) %}
    {{ _print_cert(host, port, get_cert(host,port)) }}
{% endmacro %}

{% macro print_cert_smtp(host, port) %}
    {{ _print_cert(host, port, get_cert_smtp(host, port)) }}
{% endmacro %}

{% macro print_cert(c) %}
    <h2>{{ c.host }}:{{ c.port }}</h2>
    <ul>
        <li><span class="label">Från:</span> {{  c.cert.from_d|df }}</li>
        <li><span class="label">Till:</span> {{ c.cert.to_d|df }}</li>
        <li><span class="label">CN:</span> {{ c.cert.cn }}</li>
        <li><span class="label">AN:</span> {{ c.cert.an }}</li>
        <li><span class="code"><b>HASH:</b> {{ c.hash }}</span></li>
        <li><span class="code"><b>{{ match(c.hash,c.tlsa, 'TLSA') }}:</b> {{ c.tlsa }}</span></li>
    </ul>
{% endmacro %}

{% macro _print_cert(host,port,c) %}
    <h2>{{ host }}</h2>
    <ul>
        <li><span class="label">Från:</span> {{  c|df }}</li>
        <li><span class="label">Till:</span> {{ c[1]|df }}</li>
        <li><span class="label">CN:</span> {{ c[2] }}</li>
        <li><span class="label">AN:</span> {{ c[3] }}</li>
        <li><span class="code"><b>HASH:</b> {{ c[4].upper() }}</span></li>
        <li><span class="code"><b>{{match(c[4].upper(),get_tlsa(host,port).upper(), 'TLSA')}}:</b> {{ get_tlsa(host,port).upper() }}</span></li>
    </ul>
{% endmacro %}

{% macro print_sshfp_overview(host, port) %}
    {{ _print_sshfp(host, port, get_ssh_key(host,port)) }}
{% endmacro %}

{% macro _print_sshfp(host, port, key) %}
    <h2>{{ host }}</h2>
    <ul>
        <li><span class="code"><b>&nbsp;&nbsp;&nbsp;FP:</b> {{ key[1].upper() }}</span></li>
        <li><span class="code"><b>SSHFP:</b> {{ get_sshfp(host, key[0]).upper() }}</span></li>
    </ul>
{% endmacro %}

{% macro print_sshfp(r) %}
    <h2>{{ r.host }}:{{ r.port }}</h2>
    <ul>
        <li><span class="code"><b>&nbsp;&nbsp;&nbsp;FP:</b> {{ r.hash.upper() }}</span></li>
        <li><span class="code"><b>{{match(r.hash,r.sshfp, 'SSHFP')}}:</b> {{ r.sshfp.upper() }}</span></li>
    </ul>
{% endmacro %}

{% macro link(route, text) %}
<a href="{{ url_for(route) }}">{{ text }}</a>
{% endmacro %}

{%- macro match(test1, test2, text) -%}
    {%- if test1 == test2 -%}
<span class="green" title="Records match">
    {%- else -%}
<span class="red" title="Records don't match">
    {%- endif -%}
{{ text }}</span>{% endmacro %}

{% macro rf(f) %}
<b>{{ f.label }}</b>: {{ f }} <span style="color:red">{{ f.errors|join }}</span><br>
{% endmacro %}
